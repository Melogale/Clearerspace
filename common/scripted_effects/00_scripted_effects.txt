# MODDED EFFECTS

#bavaria

BAY_low_influence_increase = {
	custom_effect_tooltip = BAY_influence_low_increase_effect_tt
	add_to_variable = { BAY_influence = 1 }
	BAY_update_ui_effect = yes
}
BAY_moderate_influence_increase = {
	custom_effect_tooltip = BAY_influence_medium_increase_effect_tt
	add_to_variable = { BAY_influence = 3 }
	BAY_update_ui_effect = yes	
}
BAY_high_influence_increase = {
	custom_effect_tooltip = BAY_influence_high_increase_effect_tt
	add_to_variable = { BAY_influence = 5 }
	BAY_update_ui_effect = yes
}
BAY_low_influence_decrease = {
	custom_effect_tooltip = BAY_influence_low_decrease_effect_tt
	subtract_from_variable = { BAY_influence = 1 }
	BAY_update_ui_effect = yes
}
BAY_moderate_influence_decrease = {
	custom_effect_tooltip = BAY_influence_medium_decrease_effect_tt
	subtract_from_variable = { BAY_influence = 3 }
	BAY_update_ui_effect = yes
}
BAY_high_influence_decrease = {
	custom_effect_tooltip = BAY_influence_high_decrease_effect_tt
	subtract_from_variable = { BAY_influence = 5 }
	BAY_update_ui_effect = yes
}

OTT_balkan_resistance_increase = {
	custom_effect_tooltip = OTT_balkan_resistance_increase_tt
	if = {
		limit = {
			check_variable = {
				var_OTT_balkan_resistance = 8
				compare = less_than
			}
		}
		add_to_variable = { var_OTT_balkan_resistance = 1 }
	}
}
OTT_mideast_resistance_increase = {
	custom_effect_tooltip = OTT_mideast_resistance_increase_tt
	if = {
		limit = {
			check_variable = {
				var_OTT_arabic_resistance = 8
				compare = less_than
			}
		}
		add_to_variable = { var_OTT_arabic_resistance = 1 }
	}
}
OTT_resistance_increase = {
	OTT_balkan_resistance_increase = yes
	OTT_mideast_resistance_increase = yes
}
OTT_balkan_resistance_decrease = {
	custom_effect_tooltip = OTT_balkan_resistance_decrease_tt
	if = {
		limit = {
			check_variable = {
				var_OTT_balkan_resistance = 1
				compare = greater_than
			}
		}
		add_to_variable = { var_OTT_balkan_resistance = -1 }
	}
}
OTT_mideast_resistance_decrease = {
	custom_effect_tooltip = OTT_mideast_resistance_decrease_tt
	if = {
		limit = {
			check_variable = {
				var_OTT_arabic_resistance = 1
				compare = greater_than
			}
		}
		add_to_variable = { var_OTT_arabic_resistance = -1 }
	}
}
OTT_resistance_decrease = {
	OTT_balkan_resistance_decrease = yes
	OTT_mideast_resistance_decrease = yes
}

BAY_update_ui_effect = {
	clamp_variable = {
		var = BAY_influence
		min = 0
		max = 100
	}
	if = {
		limit = {
			check_variable = { BAY_influence = 0 }
		}
		set_variable = { BAY_influence_meter_value = 1 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 5 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 2 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 10 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 3 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 15 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 4 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 20 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 5 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 25 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 6 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 30 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 7 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 35 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 8 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 40 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 9 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 45 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 10 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 50 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 11 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 55 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 12 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 60 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 13 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 65 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 14 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 70 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 15 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 75 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 16 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 80 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 17 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 85 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 18 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 90 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 19 }
	}
	else_if = {
		limit = {
			check_variable = { BAY_influence = 95 compare = less_than_or_equals }
		}
		set_variable = { BAY_influence_meter_value = 20 }
	}
	else = { 
		set_variable = { BAY_influence_meter_value = 21 }
	}
}


#ottomans


the_great_revolts = {
	the_balkan_revolts = yes
	the_arabic_revolts = yes
	set_global_flag = OTT_the_great_revolt_FLG
}

	#balkans
the_balkan_revolts = {
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 1
				compare = equals
			}
		}
		weak_serb_revolt = yes
		weak_bulgar_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 2
				compare = equals
			}
		}
		weak_serb_revolt = yes
		weak_bulgar_revolt = yes
		weak_greek_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 3
				compare = equals
			}
		}
		weak_serb_revolt = yes
		weak_bulgar_revolt = yes
		weak_greek_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_strengthen_anti_romanian_nationalism
					}
				}
			}
			romanian_revolt = yes
		}
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 4
				compare = equals
			}
		}
		weak_serb_revolt = yes
		weak_bulgar_revolt = yes
		weak_greek_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_strengthen_anti_romanian_nationalism
					}
				}
			}
			romanian_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_increase_military_presence_in_sicily
					}
				}
			}
			sicilian_revolt = yes
		}
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 5
				compare = equals
			}
		}
		strong_serb_revolt = yes
		strong_bulgar_revolt = yes
		weak_greek_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_strengthen_anti_romanian_nationalism
					}
				}
			}
			romanian_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_increase_military_presence_in_sicily
					}
				}
			}
			sicilian_revolt = yes
		}
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 6
				compare = equals
			}
		}
		strong_serb_revolt = yes
		strong_bulgar_revolt = yes
		romanian_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_increase_military_presence_in_sicily
					}
				}
			}
			sicilian_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_root_out_greek_resistance_leaders
					}
				}
			}
			strong_greek_revolt = yes
			else = {
				weak_greek_revolt = yes
			}
		}
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 7
				compare = equals
			}
		}
		strong_serb_revolt = yes
		strong_bulgar_revolt = yes
		romanian_revolt = yes
		sicilian_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_root_out_greek_resistance_leaders
					}
				}
			}
			strong_greek_revolt = yes
			else = {
				weak_greek_revolt = yes
			}
		}
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_balkan_resistance
				value = 8
				compare = equals
			}
		}
		strong_serb_revolt = yes
		strong_bulgar_revolt = yes
		romanian_revolt = yes
		sicilian_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_root_out_greek_resistance_leaders
					}
				}
			}
			strong_greek_revolt = yes
			else = {
				weak_greek_revolt = yes
			}
		}
	}
}


weak_serb_revolt = {
	SER = {
		transfer_state = 735
		add_core_state = 733
		add_core_state = 742
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 740 736 742 733 67 64 }
		}
		load_oob = "SER_revolt"
	}
}
strong_serb_revolt = {
	SER = {
		transfer_state = 735
		transfer_state = 736
		add_core_state = 733
		add_core_state = 742
		add_state_claim = 734
		add_state_claim = 788
		add_state_claim = 743
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 740 742 733 67 64 }
		}
		load_oob = "SER_strong_revolt"
	}
}
weak_bulgar_revolt = {
	BUL = {
		transfer_state = 741
		add_core_state = 738
		add_core_state = 739
		add_core_state = 734
		add_state_claim = 752
		add_state_claim = 754
		add_state_claim = 751
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 721 743 738 739 734 725 748 }
		}
		load_oob = "BUL_revolt"
	}
}
strong_bulgar_revolt = {
	BUL = {
		transfer_state = 741
		transfer_state = 721
		add_core_state = 738
		add_core_state = 739
		add_core_state = 734
		add_state_claim = 752
		add_state_claim = 754
		add_state_claim = 751
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 721 743 738 739 734 725 748 }
		}
		load_oob = "BUL_strong_revolt"
	}
}
weak_greek_revolt = {
	OTT = {
		end_puppet = GRE
	}
	GRE = {
		set_cosmetic_tag = GRE_FREED
		add_core_state = 753
		add_core_state = 745
		add_state_claim = 754
		add_state_claim = 752
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 757 755 756 745 753 754 752 }
		}
		load_oob = "GRE_revolt"
	}
}
romanian_revolt = {
	OTT = {
		end_puppet = TRA
	}
	HUN = {
		transfer_state = 746
		add_core_state = 746
	}
	TRA = {
		set_cosmetic_tag = TRA_romania
		add_core_state = 727
		add_core_state = 749
		add_core_state = 726
		add_core_state = 714
		add_core_state = 715
		add_core_state = 767
		add_core_state = 748
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 727 749 726 714 715 767 748 }
		}
		load_oob = "TRA_revolt"
	}
}
sicilian_revolt = {
	SIC = {
		transfer_state = 851
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 599 }
		}
		load_oob = "SIC_revolt"
	}
}
strong_greek_revolt = {
	OTT = {
		end_puppet = GRE
	}
	GRE = {
		set_cosmetic_tag = GRE_free
		add_core_state = 753
		add_core_state = 745
		add_state_claim = 754
		add_state_claim = 752
		add_state_claim = 751
		add_state_claim = 453
		add_state_claim = 777
		add_state_claim = 771
		add_state_claim = 770
		add_state_claim = 759
		add_state_claim = 762
		add_state_claim = 769
		add_state_claim = 760
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 757 755 756 745 753 754 752 751 453 777 771 770 759 762 769 760 }
		}
		load_oob = "GRE_strong_revolt"
	}
}
	#end of /the_balkan_revolts/


	#mideast

the_arabic_revolts = {
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 1
				compare = equals
			}
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_appease_syrian_moderates
					}
				}
			}
			syrian_revolt = yes
		}
		iraqi_revolt = yes
		weak_arab_revolts = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 2
				compare = equals
			}
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_appease_syrian_moderates
					}
				}
			}
			libyan_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_exemplify_tripolitanian_agitators
					}
				}
			}
			syrian_revolt = yes
		}
		weak_arab_revolts = yes
		iraqi_revolt = yes
		caucasus_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 3
				compare = equals
			}
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_appease_syrian_moderates
					}
				}
			}
			syrian_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_exemplify_tripolitanian_agitators
					}
				}
			}
			libyan_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = crush_arab_protests
					}
				}
			}
			strong_arab_revolts = yes
		}
		if = {
			limit = {
				OTT = {
					has_completed_focus = crush_arab_protests
				}
			}
			weak_arab_revolts = yes
		}
		iraqi_revolt = yes
		caucasus_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 4
				compare = equals
			}
		}
		syrian_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = OTT_exemplify_tripolitanian_agitators
					}
				}
			}
			libyan_revolt = yes
		}
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = crush_arab_protests
					}
				}
			}
			strong_arab_revolts = yes
		}
		if = {
			limit = {
				OTT = {
					has_completed_focus = crush_arab_protests
				}
			}
			weak_arab_revolts = yes
		}
		iraqi_revolt = yes
		caucasus_revolt = yes
		weak_kurdish_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 5
				compare = equals
			}
		}
		syrian_revolt = yes
		libyan_revolt = yes
		if = {
			limit = {
				OTT = {
					NOT = {
						has_completed_focus = crush_arab_protests
					}
				}
			}
			strong_arab_revolts = yes
		}
		if = {
			limit = {
				OTT = {
					has_completed_focus = crush_arab_protests
				}
			}
			weak_arab_revolts = yes
		}
		iraqi_revolt = yes
		caucasus_revolt = yes
		weak_kurdish_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 6
				compare = equals
			}
		}
		syrian_revolt = yes
		libyan_revolt = yes
		strong_arab_revolts = yes
		iraqi_revolt = yes
		caucasus_revolt = yes
		weak_kurdish_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 7
				compare = equals
			}
		}
		syrian_revolt = yes
		libyan_revolt = yes
		united_arab_revolt = yes
		iraqi_revolt = yes
		caucasus_revolt = yes
		weak_kurdish_revolt = yes
	} 
	if = {
		limit = {
			check_variable = {
				var = var_OTT_arabic_resistance
				value = 8
				compare = equals
			}
		}
		syrian_revolt = yes
		libyan_revolt = yes
		united_arab_revolt = yes
		iraqi_revolt = yes
		caucasus_revolt = yes
		strong_kurdish_revolt = yes
		azeri_revolt = yes
	}
}

syrian_revolt = {
	SYR = {
		transfer_state = 869
		add_core_state = 870
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 866 864 862 780 774 871 868 870 }
		}
		load_oob = "SYR_revolt"
	}
}
iraqi_revolt = {
	IRQ = {
		transfer_state = 109
		add_core_state = 878
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 880 881 861 863 878 }
		}
		load_oob = "IRQ_revolt"
	}
}
libyan_revolt = {
	LIB = {
		transfer_state = 960
		transfer_state = 959
		declare_war_on = {
			target = OTT
			type = take_core_state 
			generator = { 957 958 955 956 970 }
		}
		load_oob = LIB_revolt
	}
}
caucasus_revolt = { #caucaSUS???? amogus ????? HUH????? wuh huh ????//
	GEO = {
		transfer_state = 483
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 482 }
		}
		load_oob = "GEO_revolt"
	}
	ARM = {
		transfer_state = 480
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 498 496 }
		}
		load_oob = "ARM_revolt"
	}
}
weak_arab_revolts = {
	ARB = {
		transfer_state = 873
		country_event = {
			id = ottoman.21
		}
		load_oob = "ARB_weak_revolt"
	}
}
strong_arab_revolts = {
	ARB = {
		transfer_state = 873
		country_event = {
			id = ottoman.22
		}
		load_oob = "ARB_strong_revolt"
	}
}
united_arab_revolt = {
	ARB = {
		transfer_state = 873
		transfer_state = 883
		country_event = {
			id = ottoman.23
		}
		load_oob = "ARB_united_revolt"
	}
}
weak_kurdish_revolt = {
	KUR = {
		transfer_state = 787
		add_core_state = 787
		add_core_state = 782
		add_core_state = 781
		add_core_state = 780
		add_core_state = 862
		add_core_state = 863
		add_core_state = 861
		add_core_state = 852
		add_core_state = 74
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 782 780 781 862 863 861 852 74 }
		}
		load_oob = "KUR_weak_revolt"
	}
}
strong_kurdish_revolt = {
	KUR = {
		transfer_state = 787
		transfer_state = 781
		transfer_state = 861
		add_core_state = 787
		add_core_state = 782
		add_core_state = 781
		add_core_state = 780
		add_core_state = 862
		add_core_state = 863
		add_core_state = 861
		add_core_state = 852
		add_core_state = 74
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 782 780 862 863 852 74 }
		}
		load_oob = "KUR_strong_revolt"
	}
}
azeri_revolt = {
	AZR = {
		transfer_state = 481
		add_core_state = 481
		add_core_state = 496
		add_core_state = 498
		add_core_state = 857
		add_core_state = 855
		declare_war_on = {
			target = OTT
			type = take_core_state
			generator = { 496 498 857 855 }
		}
		load_oob = "AZR_revolt"
	}
}






#####################################
### emergency_factory_conversion ####
#####################################

#This is going to give misleading and ugly tooltips. Making it nice will take effort. TODO_WTT_CD make nice or ignore and remove comment. Easiest solution is just making a custom tooltip that says "5 civilian factories will be converted to military factories" and ignore telling the player the states where it will happen.

replace_civ_with_arms_factories = {

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}

#Country scope
ROOT_inherit_current_scope_wars_effect = {
	custom_effect_tooltip = ROOT_inherit_current_scope_wars_effect
	hidden_effect = {
		every_country = {
			limit = {
				has_defensive_war_with = PREV
			}
			ROOT = { declare_war_on = { target = PREV type = annex_everything } }
		}
		every_country = {
			limit = {
				has_offensive_war_with = PREV
			}
			declare_war_on = { target = ROOT type = annex_everything }
		}
	}
}


print_variable_log_effect = {
	print_variables = {
		file = variables_yug
		append = yes
	}
}



clear_sabotaged_resources_if_necesary = {
	if = {
		limit = {
			not = {
				has_dynamic_modifier = {
					modifier = sabotaged_resources
				}
			}
		}

		clear_variable = sabotaged_oil
		clear_variable = sabotaged_aluminium
		clear_variable = sabotaged_rubber
		clear_variable = sabotaged_tungsten
		clear_variable = sabotaged_steel
		clear_variable = sabotaged_chromium
	}
}


#expectes a temp variable country_to_initiate which should contain original_tag to instantiate as a collabration government
instantiate_collaboration_government = {
	custom_effect_tooltip = compliance_80_effect_tooltip
	hidden_effect = {
		set_variable = { collaboration_formed@var:country_to_initiate = 1 }

		if = {
			# if country_to_initiate does not exist, simply release it as a puppet
			limit = {
				var:country_to_initiate = {
					exists = no
				}
			}
			var:country_to_initiate = { set_variable = { collaboration_formed_by = PREV } }
			release_autonomy = {
				target = country_to_initiate
				autonomy_state = autonomy_collaboration_government
				freedom_level = 0.5
				release_non_owned_controlled = yes
			}
		}
		else = {
			# if country_to_initiate exists, create a dynamic country as our new puppet

			create_dynamic_country = {
				original_tag = country_to_initiate

				set_variable = { collaboration_formed_by = PREV }
				set_temp_variable = { new_country = this }

				PREV = {
					every_controlled_state = {
						limit = { occupied_country_tag = country_to_initiate }

						var:new_country = {
							transfer_state = PREV
						}
					}

					puppet = new_country

					set_autonomy = {
						target = new_country
						autonomy_state = autonomy_collaboration_government
						freedom_level = 0.5
					}
				}
			}
		}
	}
}

abandon_colony_tag = {
	if = {
		limit = {
			is_subject = yes
		}
		if = {
			limit = {
				original_tag = CAN
			}
			if = {
				limit = { NOT = { has_dlc = "Together for Victory" } }
				set_cosmetic_tag = CAN_ALY
			}
			else = {
				set_cosmetic_tag = CAN_UK
			}
		}
		else_if = {
			limit = {
				original_tag = RAJ
			}
			set_cosmetic_tag = RAJ_UK
		}
		else_if = {
			limit = {
				original_tag = MAL
			}
			set_cosmetic_tag = MAL_UK
		}
		else_if = {
			limit = {
				original_tag = INS
			}
			set_cosmetic_tag = INS_HOL
		}
	}
	else = {
		if = {
			limit = {
				OR = {
					has_cosmetic_tag = united_polynesia
					has_cosmetic_tag = MAJ_UNIFIED
				}
			}
		}
		else = {
			drop_cosmetic_tag = yes
		}
	}
}

upgrade_economy_law = {
	if = {
		limit = {
			has_idea = civilian_economy
		}
		add_ideas = low_economic_mobilisation
	}
	else_if = {
		limit = {
			has_idea = low_economic_mobilisation
		}
		add_ideas = partial_economic_mobilisation
	}
	else_if = {
		limit = {
			has_idea = partial_economic_mobilisation
		}
		add_ideas = war_economy
	}
	else_if = {
		limit = {
			has_idea = war_economy
		}
		add_ideas = tot_economic_mobilisation
	}
	else = {
		add_political_power = 150
	}
}

gain_random_agency_upgrade = { #Gives a random agency upgrade or grants a free agency if one has not yet been established
	custom_effect_tooltip = free_agency_upgrade_tt
	hidden_effect = {
		if = {
			limit = {
				has_intelligence_agency = no
			}
			create_intelligence_agency = yes
		}
		else = {
			random_list = {
				1 = {
					upgrade_intelligence_agency = upgrade_economy_civilian
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_economy_civilian
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_army_department
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_army_department
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_naval_department
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_naval_department
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_airforce_department
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_airforce_department
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_passive_defense
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_passive_defense
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_anti_partisan
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_anti_partisan
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_blueprint_stealing
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_blueprint_stealing
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_portable_radios
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_portable_radios
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_invisible_ink
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_invisible_ink
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_plastic_explosives
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_plastic_explosives
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_suicide_pills
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_suicide_pills
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_training_centers
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_training_centers
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_commando_training
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_commando_training
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_interrogation_techniques
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_interrogation_techniques
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_diplo_training
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_diplo_training
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_psycho_warfare
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_psycho_warfare
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_form_department
					modifier = {
						factor = 0
						has_done_agency_upgrade = upgrade_form_department
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_decryption_boost
					modifier = {
						factor = 0
						OR = {
							has_done_agency_upgrade = upgrade_decryption_boost
							NOT = { has_done_agency_upgrade = upgrade_form_department }
						}
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_decryption_boost_2
					modifier = {
						factor = 0
						OR = {
							has_done_agency_upgrade = upgrade_decryption_boost_2
							NOT = { has_done_agency_upgrade = upgrade_form_department }
							NOT = { has_done_agency_upgrade = upgrade_decryption_boost }
						}
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_crypto_strength
					modifier = {
						factor = 0
						OR = {
							has_done_agency_upgrade = upgrade_crypto_strength
							NOT = { has_done_agency_upgrade = upgrade_form_department }
						}
					}
				}
				1 = {
					upgrade_intelligence_agency = upgrade_crypto_strength_2
					modifier = {
						factor = 0
						OR = {
							has_done_agency_upgrade = upgrade_crypto_strength_2
							NOT = { has_done_agency_upgrade = upgrade_form_department }
							NOT = { has_done_agency_upgrade = upgrade_crypto_strength }
						}
					}
				}
			}
		}
	}
}


on_daily = {

}



###Game weight variables for faction load balancing.
###We store these on germany because ... we have to


bba_create_cas_license_effect = { #this assumes that the corresponding get_cas_effect has run already to generate a design template if necessary
	if = {
		limit = {
			has_tech = advanced_small_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = small_plane_cas_airframe_3
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = improved_small_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = small_plane_cas_airframe_2
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = basic_small_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = small_plane_cas_airframe_1
			}
			cost_factor = 0
		}
	}
}

bba_create_fighter_license_effect = { #this assumes that the corresponding get_fighter_effect has run already to generate a design template if necessary
	if = {
		limit = {
			has_tech = advanced_small_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = small_plane_airframe_3
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = improved_small_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = small_plane_airframe_2
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = basic_small_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = small_plane_airframe_1
			}
			cost_factor = 0
		}
	}
}

bba_create_tac_license_effect = { #this assumes that the corresponding get_tac_effect has run already to generate a design template if necessary
	if = {
		limit = {
			has_tech = advanced_medium_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = medium_plane_airframe_3
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = improved_medium_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = medium_plane_airframe_2
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = basic_medium_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = medium_plane_airframe_1
			}
			cost_factor = 0
		}
	}
}

bba_create_heavy_fighter_license_effect = { #this assumes that the corresponding get_fighter_effect has run already to generate a design template if necessary
	if = {
		limit = {
			has_tech = advanced_medium_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = medium_plane_fighter_airframe_3
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = improved_medium_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = medium_plane_fighter_airframe_2
			}
			cost_factor = 0
		}
	}
	else_if = {
		limit = {
			has_tech = basic_medium_airframe
		}
		create_production_license = {
			target = event_target:license_target
			equipment = {
				type = medium_plane_fighter_airframe_1
			}
			cost_factor = 0
		}
	}
}

remove_any_country_role_from_character = { #Expected to be used inside the character scope
	#log = "I am [THIS.GetName]"
	if = {
		limit = {
			is_character_slot = air_chief
		}
		remove_advisor_role = { slot = air_chief }
	}
	if = {
		limit = {
			is_character_slot = army_chief
		}
		remove_advisor_role = { slot = army_chief }
	}
	if = {
		limit = {
			is_character_slot = navy_chief
		}
		remove_advisor_role = { slot = navy_chief }
	}
	if = {
		limit = {
			is_character_slot = high_command
		}
		remove_advisor_role = { slot = high_command }
	}
	if = {
		limit = {
			is_character_slot = theorist
		}
		remove_advisor_role = { slot = theorist }
	}
	if = {
		limit = {
			is_character_slot = political_advisor
		}
		remove_advisor_role = { slot = political_advisor }
	}
}